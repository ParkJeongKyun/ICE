"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[396],{2497:(e,t,r)=>{r.d(t,{I:()=>d,q:()=>m});var n=r(95155),a=r(12115),i=r(71983),s=r(98414),o=r(94213);class l{initWorker(){this.worker=this.workerFactory(),this.setupListener()}respawnWorker(){console.warn("[WorkerManager] Respawning worker..."),this.worker.terminate(),this.initWorker()}setupListener(){this.worker.onmessage=e=>{var t,r;let{status:n,taskType:a,data:i,stats:o,errorCode:l,id:u}=e.data,c=null!=(t=null!=u?u:null==o?void 0:o.id)?t:"";switch(n){case"WASM_READY":this.events.emit("WASM_READY");break;case"PROGRESS":o&&this.events.emit("PROGRESS",o);break;case"SUCCESS":let h=this.pendingRequests.get(c);if(!h)break;"PROCESS_EXIF"===h.taskType&&i&&"object"==typeof i&&"mimeType"in i&&(0,s.isImageMimeType)(i.mimeType)?this.handleThumbnail(c,h,i,o):this.resolveRequest(c,h,i,o);break;case"ERROR":let d=this.pendingRequests.get(c);d&&(this.events.emit("ERROR",{code:l||"WORKER_ERROR"}),d.reject(Error(l||"Unknown error")),c&&this.pendingRequests.delete(c),null==(r=this.stopProcessing)||r.call(this))}},this.worker.onerror=e=>{var t;console.error("[WorkerManager] Critical Worker Error:",e.message),this.pendingRequests.forEach(t=>{t.reject(Error("WORKER_ERROR: ".concat(e.message)))}),this.pendingRequests.clear(),null==(t=this.stopProcessing)||t.call(this),this.events.emit("ERROR",{code:"WORKER_ERROR"})}}resolveRequest(e,t,r,n){var a;t.resolve({data:r,stats:n}),this.events.emit("DONE",{type:t.taskType,result:r,stats:n}),this.pendingRequests.delete(e),null==(a=this.stopProcessing)||a.call(this)}handleThumbnail(e,t,n,a){"object"==typeof n&&null!==n&&"exifInfo"in n&&"mimeType"in n&&n.exifInfo&&!n.exifInfo.thumbnail&&t.file?Promise.resolve().then(r.bind(r,98414)).then(e=>{let{generateThumbnailInMainThread:r}=e;return r(t.file,n.mimeType)}).then(r=>{r&&(n.exifInfo.thumbnail=r),this.resolveRequest(e,t,n,a)}).catch(r=>{console.error("[WorkerManager] Thumbnail generation failed:",r),this.resolveRequest(e,t,n,a)}):this.resolveRequest(e,t,n,a)}calculateDynamicTimeout(e,t){var r;if(!t||t<=0)return 3e4;let{baseTime:n,minSpeed:a}=null!=(r=({PROCESS_HASH:{baseTime:3e4,minSpeed:5},PROCESS_EXIF:{baseTime:3e4,minSpeed:10},SEARCH_HEX:{baseTime:3e4,minSpeed:10},SEARCH_ASCII:{baseTime:3e4,minSpeed:10}})[e])?r:{baseTime:3e4,minSpeed:10};return Math.round(Math.min(n+t/1048576/a*2e3,12e5))}async execute(e,t){var r,n,a;let s=crypto.randomUUID();null==(r=this.startProcessing)||r.call(this);let o=null!=(a=({PROCESS_HASH:"HASH_TIMEOUT",PROCESS_EXIF:"EXIF_TIMEOUT",SEARCH_HEX:"SEARCH_TIMEOUT",SEARCH_ASCII:"SEARCH_TIMEOUT"})[e])?a:"TIMEOUT",l=null==(n=t.file)?void 0:n.size,u=this.calculateDynamicTimeout(e,l);return new Promise((r,n)=>{let a=setTimeout(()=>{var e;this.respawnWorker(),this.pendingRequests.delete(s),null==(e=this.stopProcessing)||e.call(this),this.events.emit("ERROR",{code:o}),n(Error(o))},u);this.pendingRequests.set(s,{resolve:e=>{var t;clearTimeout(a),null==(t=this.stopProcessing)||t.call(this),r(e)},reject:e=>{var t;clearTimeout(a),null==(t=this.stopProcessing)||t.call(this),n(e)},taskType:e,file:"file"in t&&t.file instanceof File?t.file:void 0}),this.worker.postMessage((0,i._)({type:e,id:s},t))})}cancel(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"USER_CANCELLED";0!==this.pendingRequests.size&&(this.pendingRequests.forEach(e=>{e.reject(Error(t))}),this.respawnWorker(),this.pendingRequests.clear(),null==(e=this.stopProcessing)||e.call(this),this.events.emit("ERROR",{code:t}))}terminate(){var e;this.pendingRequests.forEach(e=>{e.reject(Error("WORKER_TERMINATED"))}),this.worker.terminate(),this.pendingRequests.clear(),this.events.all.clear(),null==(e=this.stopProcessing)||e.call(this)}constructor(e,t){this.pendingRequests=new Map,this.workerFactory=e,this.events=(0,o.A)(),this.startProcessing=null==t?void 0:t.startProcessing,this.stopProcessing=null==t?void 0:t.stopProcessing,this.initWorker()}}var u=r(90880),c=r(10712);let h=(0,a.createContext)(void 0),d=e=>{let{children:t}=e,[i,s]=(0,a.useState)({hashManager:null,analysisManager:null,chunkWorker:null}),[o,d]=(0,a.useState)(!1),{startHashProcessing:m,stopHashProcessing:g,startAnalysisProcessing:f,stopAnalysisProcessing:R}=(0,u.Z)();(0,a.useEffect)(()=>{f();let e=null,t=null,n=null;try{let a=new Worker(r.tu(new URL(r.p+r.u(4971),r.b)));return e=new l(()=>new Worker(r.tu(new URL(r.p+r.u(1132),r.b))),{startProcessing:m,stopProcessing:g}),t=new l(()=>new Worker(r.tu(new URL(r.p+r.u(6801),r.b))),{startProcessing:f,stopProcessing:R}),n=a,s({hashManager:e,analysisManager:t,chunkWorker:n}),e&&(e.events.on("PROGRESS",e=>{c.A.emit("hashProgress",e)}),e.events.on("DONE",()=>{c.A.emit("hashProgress",null)}),e.events.on("ERROR",e=>{c.A.emit("toast",{code:e.code}),c.A.emit("hashProgress",null),g()})),t&&(t.events.on("WASM_READY",()=>{d(!0),R()}),t.events.on("PROGRESS",e=>{c.A.emit("analysisProgress",e)}),t.events.on("DONE",()=>{c.A.emit("analysisProgress",null)}),t.events.on("ERROR",e=>{c.A.emit("toast",{code:e.code}),c.A.emit("analysisProgress",null),R()})),()=>{null==e||e.terminate(),null==t||t.terminate(),null==n||n.terminate()}}catch(e){console.error("[WorkerContext] Failed to create workers:",e),R(),c.A.emit("toast",{code:"WORKER_CREATION_FAILED"})}},[]);let v=(0,a.useMemo)(()=>({hashManager:i.hashManager,analysisManager:i.analysisManager,chunkWorker:i.chunkWorker,isWasmReady:o}),[i,o]);return(0,n.jsx)(h.Provider,{value:v,children:t})},m=()=>{let e=(0,a.useContext)(h);if(!e)throw Error("useWorker must be used within WorkerProvider");return e}},10712:(e,t,r)=>{r.d(t,{A:()=>n});let n=(0,r(94213).A)()},28014:(e,t,r)=>{r.d(t,{B:()=>o,I:()=>l});var n=r(95155),a=r(12115),i=r(42533);let s=(0,a.createContext)(void 0),o=e=>{let{children:t}=e,r=(0,a.useRef)(new Map),o=(0,a.useRef)(new Set),l=(0,a.useCallback)(e=>{var t;let n=Math.floor(e/i.OZ)*i.OZ,a=r.current.get(n);if(!a)return null;let s=e-n;return s<0||s>=a.length?null:null!=(t=a[s])?t:null},[]),u=(0,a.useCallback)(()=>{let e=r.current,t=0;if(e.forEach(e=>{t+=e.byteLength}),t>0x3200000){let t=Array.from(e.entries()),r=Math.floor(t.length/2);for(let n=0;n<r;n++){let[r]=t[n];e.delete(r),o.current.delete(r)}}},[]),c=a.useMemo(()=>({chunkCacheRef:r,requestedChunksRef:o,getByte:l,checkCacheSize:u}),[l,u]);return(0,n.jsx)(s.Provider,{value:c,children:t})},l=()=>{let e=(0,a.useContext)(s);if(!e)throw Error("useHexViewerCacheContext must be used within HexViewerCacheProvider");return e}},42533:(e,t,r)=>{r.d(t,{Ao:()=>s,D$:()=>g,I6:()=>m,I_:()=>l,OZ:()=>a,SK:()=>o,UC:()=>h,Wz:()=>c,XZ:()=>i,rs:()=>u,us:()=>d});var n=r(92253);let a=262144,i=262144,s=1e5,o=50,l=50,u=n.Fr?{containerPadding:5,gap:4,bytesPerRow:16,rowHeight:15,headerHeight:15,font:"9px monospace",offsetWidth:44,hexByteWidth:14,asciiCharWidth:7}:{containerPadding:10,gap:10,bytesPerRow:16,rowHeight:22,headerHeight:22,font:"14px monospace",offsetWidth:75,hexByteWidth:26,asciiCharWidth:12},c=u.containerPadding,h=c+u.offsetWidth+u.gap,d=h+u.bytesPerRow*u.hexByteWidth+u.gap,m=2*u.containerPadding+u.offsetWidth+2*u.gap+u.bytesPerRow*u.hexByteWidth+u.bytesPerRow*u.asciiCharWidth,g={HEX_EVEN:"--main-color-reverse",HEX_ODD:"--main-color",ASCII:"--main-color",ASCII_DISABLED:"--main-disabled-color",SELECTED_BG:"--main-hover-color",SELECTED_TEXT:"--ice-main-color",OFFSET:"--ice-main-color-reverse",BG:"--main-bg-color"}},49396:(e,t,r)=>{r.d(t,{Cd:()=>v,KH:()=>E,Ll:()=>R,Vh:()=>f,WF:()=>m,rB:()=>g});var n=r(71983),a=r(45849),i=r(17389),s=r(59990),o=r(95155),l=r(12115);let u=(0,l.createContext)(void 0),c=(0,l.createContext)(void 0),h=(0,l.createContext)(void 0),d=(0,l.createContext)(void 0),m=[{value:"ascii",label:"ASCII"},{value:"ansi",label:"ANSI(Windows-1252)"},{value:"oem",label:"OEM(CP437)"},{value:"mac",label:"Macintosh(Mac Roman)"},{value:"ebcdic",label:"EBCDIC(IBM Mainframe)"}],g=e=>{let{children:t}=e,[r,m]=(0,l.useState)({}),[g,f]=(0,l.useState)(""),[R,v]=(0,l.useState)("ansi"),[E,w]=(0,l.useState)({}),[b,p]=(0,l.useState)({}),[C,S]=(0,l.useState)([]),[P,y]=(0,l.useState)({}),k=(0,l.useCallback)(e=>{v(e)},[]),T=(0,l.useCallback)((e,t,r,i)=>{let s="string"==typeof t?parseFloat(t):t,o="string"==typeof r?parseFloat(r):r,l="".concat(s,",").concat(o);y(t=>{var r;return(0,a._)((0,n._)({},t),{[e]:(0,a._)((0,n._)({},t[e]),{[l]:(0,n._)({},null==(r=t[e])?void 0:r[l],i)})})})},[]),M=(0,l.useCallback)(()=>"tab-".concat(crypto.randomUUID()),[]),I=r[g],x=0===Object.keys(r).length,A=(0,l.useCallback)((e,t)=>{S(r=>{let n=[...r],[a]=n.splice(e,1);return n.splice(t,0,a),n})},[]),O=(0,l.useCallback)(e=>{m(t=>{j(t[e]);let{[e]:r}=t;return(0,i._)(t,[e].map(s._))}),w(t=>{let{[e]:r}=t;return(0,i._)(t,[e].map(s._))}),p(t=>{let{[e]:r}=t;return(0,i._)(t,[e].map(s._))}),S(t=>t.filter(t=>t!==e))},[]);(0,l.useEffect)(()=>{let e=Object.keys(r);C.length===e.length&&C.every(t=>e.includes(t))||S(t=>[...t.filter(t=>e.includes(t)),...e.filter(e=>!t.includes(e))])},[r,C]);let _=(0,l.useMemo)(()=>b[g]||{cursor:null,start:null,end:null,isDragging:!1,dragStart:null,selectedBytes:void 0},[b,g]),W=(0,l.useMemo)(()=>({tabData:r,setTabData:m,activeKey:g,setActiveKey:f,getNewKey:M,activeData:I,isEmpty:x,encoding:R,setEncoding:k,deleteTab:O,tabOrder:C,setTabOrder:S,reorderTabs:A}),[r,g,R,k,C,M,O,A]),D=(0,l.useMemo)(()=>({addressCache:P,updateAddressCache:T}),[P,T]),U=(0,l.useMemo)(()=>({scrollPositions:E,setScrollPositions:w}),[E]),H=(0,l.useMemo)(()=>({selectionStates:b,setSelectionStates:p,activeSelectionState:_}),[b,_]),L=l.useRef(r);l.useEffect(()=>{L.current=r},[r]);let j=e=>{var t;if(!e)return;let r=null==(t=e.exifInfo)?void 0:t.thumbnail;if(r)try{URL.revokeObjectURL(r)}catch(e){}};return l.useEffect(()=>()=>{Object.values(L.current).forEach(e=>j(e))},[]),(0,o.jsx)(c.Provider,{value:W,children:(0,o.jsx)(u.Provider,{value:D,children:(0,o.jsx)(h.Provider,{value:U,children:(0,o.jsx)(d.Provider,{value:H,children:t})})})})},f=()=>{let e=(0,l.useContext)(c);if(!e)throw Error("useTab must be used within a TabDataProvider");return e},R=()=>{let e=(0,l.useContext)(h);if(!e)throw Error("useScroll must be used within a TabDataProvider");return e},v=()=>{let e=(0,l.useContext)(d);if(!e)throw Error("useSelection must be used within a TabDataProvider");return e},E=()=>{let e=(0,l.useContext)(u);if(!e)throw Error("useAddressCache must be used within a TabDataProvider");return e}},81836:(e,t,r)=>{r.d(t,{t:()=>s,u:()=>o});var n=r(95155),a=r(12115);let i=(0,a.createContext)(void 0),s=e=>{let{children:t}=e,r=(0,a.useRef)(null),s=(0,a.useRef)(null),o=(0,a.useRef)(null),l=(0,a.useRef)(null);return(0,n.jsx)(i.Provider,{value:{hexViewerRef:r,searcherRef:s,menuBtnZoneRef:o,modalRef:l,setSearcherRef:e=>{s.current=e},setMenuBtnZoneRef:e=>{o.current=e},setModalRef:e=>{l.current=e},openModal:e=>{var t;null==(t=l.current)||t.open(e)}},children:t})},o=()=>{let e=(0,a.useContext)(i);if(!e)throw Error("useRefs must be used within RefProvider");return e}},90880:(e,t,r)=>{r.d(t,{Z:()=>o,v:()=>s});var n=r(95155),a=r(12115);let i=(0,a.createContext)(void 0),s=e=>{let{children:t}=e,[r,s]=(0,a.useState)(0),[o,l]=(0,a.useState)(0);(0,a.useEffect)(()=>{let e=e=>{(r>0||o>0)&&(e.preventDefault(),e.returnValue="")};return window.addEventListener("beforeunload",e),()=>window.removeEventListener("beforeunload",e)},[r,o]);let u=(0,a.useCallback)(()=>{s(e=>e+1)},[]),c=(0,a.useCallback)(()=>{s(e=>Math.max(0,e-1))},[]),h=(0,a.useCallback)(()=>{l(e=>e+1)},[]),d=(0,a.useCallback)(()=>{l(e=>Math.max(0,e-1))},[]),m=(0,a.useMemo)(()=>({isHashProcessing:r>0,startHashProcessing:u,stopHashProcessing:c,isAnalysisProcessing:o>0,startAnalysisProcessing:h,stopAnalysisProcessing:d,isProcessing:r>0||o>0}),[r,o,u,c,h,d]);return(0,n.jsx)(i.Provider,{value:m,children:t})},o=()=>{let e=(0,a.useContext)(i);if(!e)throw Error("useProcess must be used within a ProcessProvider");return e}},98414:(e,t,r)=>{function n(e){return!!e&&e.startsWith("image/")}function a(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:300,n=e,a=t;return n>a?n>r&&(a=Math.round(a*r/n),n=r):a>r&&(n=Math.round(n*r/a),a=r),{width:n,height:a}}async function i(e){try{if(!e)return null;let t=await fetch(e);return await t.blob()}catch(e){return console.error("[thumbnail] Data URL to Blob conversion failed:",e),null}}async function s(e,t){let r=t.toLowerCase();try{if("image/heic"===r||"image/heif"===r)return await o(e);if("image/tiff"===r||"image/tif"===r)return await l(e);return await u(e)}catch(e){return console.error("[thumbnail] Thumbnail generation failed:",e),null}}async function o(e){try{let t=(await r.e(2e3).then(r.t.bind(r,2402,23))).default,n=await t({blob:e,toType:"image/jpeg",quality:.8}),a=Array.isArray(n)?n[0]:n;return await c(a)}catch(e){console.error("[thumbnail] HEIC thumbnail generation failed:",e)}return null}async function l(e){try{let t=await r.e(3561).then(r.t.bind(r,13561,23)),n=t.default||t,i=await e.arrayBuffer(),s=n.decode(i);if(s&&s.length>0){let e=s[0];n.decodeImage(i,e);let t=document.createElement("canvas");t.width=e.width,t.height=e.height;let r=t.getContext("2d");if(r){let n=r.createImageData(e.width,e.height);!function(e,t){if(t instanceof Uint32Array)for(let r=0;r<t.length;r++){let n=t[r];e[4*r+0]=(0|n)&255,e[4*r+1]=n>>8&255,e[4*r+2]=n>>16&255,e[4*r+3]=n>>24&255}else e.set(t)}(n.data,e.data),r.putImageData(n,0,0);let{width:i,height:s}=a(e.width,e.height),o=document.createElement("canvas");o.width=i,o.height=s;let l=o.getContext("2d");if(l){l.imageSmoothingEnabled=!0,l.imageSmoothingQuality="high",l.drawImage(t,0,0,i,s);let e=h()?"image/webp":"image/jpeg",r=await m(o,e,.8);return await d(r)}}}}catch(e){console.error("[thumbnail] TIFF thumbnail generation failed:",e)}return null}async function u(e){try{return await c(e)}catch(e){return console.error("[thumbnail] Standard thumbnail generation failed:",e),null}}async function c(e){let t=URL.createObjectURL(e);try{let r=await function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e3;return new Promise((r,n)=>{let a=new Image,i=setTimeout(()=>n(Error("Image load timeout")),t);a.onload=()=>{clearTimeout(i),r(a)},a.onerror=()=>{clearTimeout(i),n(Error("Image load failed"))},a.src=e})}(t,3e3),n=Math.max(r.width/4096,r.height/4096,1),i=Math.ceil(r.width/n),s=Math.ceil(r.height/n),{width:o,height:l}=a(i,s,300);if(i<=o&&s<=l)return await d(e);let u=document.createElement("canvas");u.width=o,u.height=l;let c=u.getContext("2d");if(!c)throw Error("Failed to get 2D context");c.imageSmoothingEnabled=!0,c.imageSmoothingQuality="high",c.drawImage(r,0,0,o,l);let g=h()?"image/webp":"image/jpeg",f=await m(u,g,.8);return await d(f)}finally{URL.revokeObjectURL(t)}}function h(){let e=document.createElement("canvas");return e.width=e.height=1,5===e.toDataURL("image/webp").indexOf("webp")}async function d(e){return new Promise((t,r)=>{let n=new FileReader;n.onload=()=>t(n.result),n.onerror=()=>r(n.error),n.readAsDataURL(e)})}function m(e,t,r){return new Promise((n,a)=>{e.toBlob(e=>{e?n(e):a(Error("Canvas to Blob conversion failed"))},t,r)})}r.r(t),r.d(t,{dataUrlToBlob:()=>i,generateThumbnailInMainThread:()=>s,isImageMimeType:()=>n})}}]);