(()=>{"use strict";class e{processQueue(){for(this.queue.sort((e,s)=>e.priority-s.priority);this.queue.length>0&&this.activeRequests<this.MAX_CONCURRENT;){let e=this.queue.shift();if(!e)break;this.activeRequests++,this.processChunk(e)}}async processChunk(e){try{let{file:s,offset:t,length:r}=e,u=s.slice(t,t+r),a=await u.arrayBuffer(),i=new Uint8Array(a);self.postMessage({status:"SUCCESS",data:{offset:t,buffer:i.buffer}},[i.buffer])}catch(s){self.postMessage({status:"ERROR",data:{offset:e.offset},errorCode:"CHUNK_READ_ERROR"})}finally{this.activeRequests--,this.processQueue()}}handle(e){"READ_CHUNK"===e.type?(this.queue.push(e),this.processQueue()):"CANCEL_ALL"===e.type&&(this.queue=[])}constructor(){this.queue=[],this.MAX_CONCURRENT=4,this.activeRequests=0}}self.addEventListener("error",e=>{self.postMessage({status:"ERROR",errorCode:"WORKER_ERROR"})}),self.addEventListener("unhandledrejection",e=>{self.postMessage({status:"ERROR",errorCode:"WORKER_ERROR"})});let s=new e;self.addEventListener("message",e=>{s.handle(e.data)})})(),_N_E={};